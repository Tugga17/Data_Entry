self.loader = ttk.Label(self.window, text="Uploading...", foreground="blue")
self.loader.pack_forget()  # Hide it initially

def show_loader(self):
    self.loader.pack()
    self.window.update_idletasks()

def hide_loader(self):
    self.loader.pack_forget()
    self.window.update_idletasks()

def run_upload_threaded(self):
    self.show_loader()
    thread = threading.Thread(target=self.upload_files_safely)
    thread.start()

def upload_files_safely(self):
    try:
        self.upload_files()  # <- your actual upload logic here
    finally:
        self.window.after(100, self.hide_loader)

tk.Button(..., command=self.run_upload_threaded)


def trigger_custom_perfman_upload(self):
    from tkinter import Tk
    root = Tk()
    root.withdraw()  # Hide main window

    excel_path = filedialog.askopenfilename(
        title="Select Excel File to Upload to Perfman",
        filetypes=[("Excel files", "*.xlsx *.xlsm *.xls")]
    )

    if excel_path:
        threading.Thread(
            target=run_perfman_uploader,
            args=(excel_path,),
            daemon=True
        ).start()