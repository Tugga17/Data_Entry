public static UPMPointsDTO GetUPMPointFromExcel(string chartID, int reportingYear, string pointDesc, string seriesDesc)
		{
			UPMPointsDTO upmpointsDTO = null;
			SqlConnection sqlConnection = new SqlConnection(PerfMgDB.ConnectionString);
			UPMPointsDTO upmpointsDTO3;
			try
			{
				sqlConnection.Open();
				string text = "dbo.usp_UPM_PointToUPMPoint_get";
				SqlDataReader sqlDataReader = new SqlCommand(text, sqlConnection)
				{
					CommandType = CommandType.StoredProcedure,
					Parameters = 
					{
						new SqlParameter("@ChartID", chartID),
						new SqlParameter("@ReportingYear", reportingYear),
						new SqlParameter("@DataSeriesDescription", seriesDesc),
						new SqlParameter("@PointDescription", pointDesc)
					}
				}.ExecuteReader();
				bool flag = sqlDataReader.Read();
				if (flag)
				{
					upmpointsDTO = new UPMPointsDTO();
					upmpointsDTO.C_ID = Conversions.ToInteger(sqlDataReader.GetValue(0));
					upmpointsDTO.DS_ID = Conversions.ToInteger(sqlDataReader.GetValue(1));
					upmpointsDTO.MetricID = Conversions.ToString(sqlDataReader.GetValue(2));
					upmpointsDTO.PointsDescription = DBNullConversions.DBNullToText(RuntimeHelpers.GetObjectValue(sqlDataReader.GetValue(3)));
					upmpointsDTO.MonthValue = Conversions.ToInteger(sqlDataReader.GetValue(4));
					UPMPointsDTO upmpointsDTO2 = upmpointsDTO;
					object obj = DBNullConversions.DBNullToNothing(RuntimeHelpers.GetObjectValue(sqlDataReader.GetValue(5)));
					decimal? num;
					upmpointsDTO2.YValue = ((obj != null) ? ((decimal?)obj) : num);
					upmpointsDTO.ReportingYear = DBNullConversions.DBNullToText(RuntimeHelpers.GetObjectValue(sqlDataReader.GetValue(6)));
				}
				upmpointsDTO3 = upmpointsDTO;
			}
			catch (Exception ex)
			{
				throw new Exception(ex.Message);
			}
			finally
			{
				bool flag = sqlConnection.State == ConnectionState.Open;
				if (flag)
				{
					sqlConnection.Close();
				}
				sqlConnection.Dispose();
			}
			return upmpointsDTO3;
		}
